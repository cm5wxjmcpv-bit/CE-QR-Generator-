<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CE QR Generator</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<style>
 body{font-family:Arial,sans-serif;background:#fff;margin:40px;text-align:center}
 h1{font-weight:600}
 input{margin:5px;padding:8px;width:250px;font-size:16px}
 button{margin-top:10px;padding:10px 20px;font-size:16px;cursor:pointer}
 #qrcode{margin-top:20px}
</style>
</head>
<body>
<h1>CE QR Generator</h1>
<input id="first" placeholder="First Name">
<input id="last" placeholder="Last Name">
<input id="cert" placeholder="Certification #"><br>
<button onclick="generateQR()">Generate QR Code</button>
<div id="message"></div>
<div id="qrcode"></div>

<script>
function generateQR(){
  const f=document.getElementById('first').value.trim().toUpperCase();
  const l=document.getElementById('last').value.trim().toUpperCase();
  const c=document.getElementById('cert').value.trim().toUpperCase();
  if(!f||!l||!c){alert("Please fill in all fields.");return;}
  const codeText=`${c}${l}|${f}`;
  const qrContainer=document.getElementById("qrcode");
  qrContainer.innerHTML='';
  const qr=new QRCode(qrContainer,{text:codeText,width:200,height:200});
  document.getElementById('message').innerText="Generating QR Code...";

  // Wait for the QR to render, then capture the image
  setTimeout(()=>{
    const imgEl=qrContainer.querySelector("img");
    const imgData=imgEl?imgEl.src:"";
    const saved=JSON.parse(localStorage.getItem("qrRecords")||"[]");
    saved.push({text:codeText,img:imgData,time:new Date().toLocaleString()});
    localStorage.setItem("qrRecords",JSON.stringify(saved));
    document.getElementById('message').innerText="QR Code generated successfully âœ…";
  },600);
}
</script>
</body>
</html>